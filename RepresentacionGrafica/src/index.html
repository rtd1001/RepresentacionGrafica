<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">

    <title>Representación gráfica de matrícula</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  </head>

  <body>
    <input type="file" id="fileUpload" accept=".xls" multiple/>
    <button type="button" id="uploadButton">Añadir</button>
  </body>

  <script>
    var fileBtn = document.getElementById("fileUpload");
    var uploadBtn = document.getElementById("uploadButton");

    fileBtn.addEventListener("change", function(event) {
      
      var fileList = this.files;

      for(var i = 0; i < fileList.length; i++){
        var currentFile = fileList[i];
        
        validateFileExtension(currentFile);
      }

    });

    function validateFileExtension(currentFile){
      var fileName = currentFile.name;
      console.log(fileName)

      var ext = fileName.split('.').pop();
      ext = ext.toLowerCase();

      if(ext != 'xls'){
        alert('El archivo ' + fileName +  ' no tiene la extensión adecuada. Vuelva a introducir otro archivo.');
        fileBtn.value = ''; 
      }

    }
  </script>
</html>
